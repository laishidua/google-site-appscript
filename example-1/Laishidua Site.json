{"files":[{"id":"d884ddec-a41e-482b-ae98-3a069eb1be43","name":"Code","type":"server_js","source":"function doGet() {     \n    return HtmlService.createTemplateFromFile(\u0027index\u0027)\n      .evaluate()\n      .setSandboxMode(HtmlService.SandboxMode.IFRAME);  \n}\n\nfunction include(filename) {\n\treturn HtmlService.createHtmlOutputFromFile(filename)\n    \t.setSandboxMode(HtmlService.SandboxMode.IFRAME)\n\t\t.getContent();\n}\n\nfunction searchContent(template, callbackname){ \n  var res \u003d new Array();\n  res[0] \u003d HtmlService.createTemplateFromFile(template).getRawContent();\n  if (callbackname !\u003d null) {\n    res[1] \u003d callbackname;    \n  }\n  return res; \n}\n\nfunction saveToSheet(usr, pwd){\n    var lock \u003d LockService.getPublicLock();\n    lock.waitLock(30000);  // wait 30 seconds before conceding defeat.\n    try {\n      var sheet \u003d SpreadsheetApp.\n      openByUrl(\u0027https://docs.google.com/spreadsheets/d/1i4naI0PKSVUWWlKkGPQ8I9-6TpMWPOb0BnQNRc6nfjI/edit\u0027)\n           .getSheetByName(\"Sheet1\");\n      var lastRow \u003d sheet.getLastRow();      \n      sheet.appendRow([usr, pwd]);\n      var lastRowRes \u003d sheet.getLastRow();\n      var res \u003d \"Error!\";\n      if (lastRowRes \u003e lastRow) {\n        res \u003d \"Success!\";\n      }\n      return res;\n    } catch(e) {\n      // if error return this\n      return \"Error!\";\n   } finally { //release lock\n      lock.releaseLock();\n   }  \n}\n\nfunction sesion_GSUserEmail(){\n  return Session.getActiveUser().getEmail();\n}\n\n"},{"id":"762395b8-3cfa-4adc-8995-038627e600e1","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n \u003chead\u003e\n    \u003cmeta charset\u003d\"utf-8\"\u003e\n    \u003ctitle\u003eLAISHIDUA SITE\u003c/title\u003e\n    \u003c?!\u003d include(\u0027StyleSheet\u0027); ?\u003e\n \u003c/head\u003e\n \u003cbody\u003e\n   \u003cdiv id\u003d\"headerContent\"\u003e \n      HERE YOU CAN PLACE A BANNER.\n   \u003c/div\u003e\n   \u003cdiv id\u003d\"indexContent\" class\u003d\"container-fluid\"\u003e      \n   \u003c/div\u003e\n   \u003cdiv id\u003d\"headerContent\"\u003e \n      HERE YOU CAN PLACE A FOOTER.\n   \u003c/div\u003e   \n \u003c/body\u003e\n \u003c?!\u003d include(\u0027JS_Libs_Ext\u0027); ?\u003e\n \u003c?!\u003d include(\u0027JS_ContentInit\u0027); ?\u003e\n \u003c?!\u003d include(\u0027JS_ContentForm\u0027); ?\u003e\n\u003c/html\u003e\n\n\n"},{"id":"bfdc25c5-82d9-4e67-b976-2432e4d80b4a","name":"contentInit","type":"html","source":"\u003ch2\u003eWelcome / Bienvenido\u003c/h2\u003e\n\n\u003ch2 id\u003d\"userEmail\"\u003e\u003c/h2\u003e\n\nTo go to the form, press the next button:\n\n\u003cbutton id\u003d\"goToForm\" type\u003d\"button\" class\u003d\"btn btn-primary\"\u003eGo\u003c/button\u003e\n\n"},{"id":"10666598-f6ff-492f-b145-93b63b5df9cb","name":"contentForm","type":"html","source":"\u003cform role\u003d\"form\"\u003e\n  \u003cdiv class\u003d\"form-group\"\u003e\n    \u003clabel for\u003d\"usr\"\u003eName:\u003c/label\u003e\n    \u003cinput type\u003d\"text\" class\u003d\"form-control\" id\u003d\"usr\"\u003e\n  \u003c/div\u003e\n  \u003cdiv class\u003d\"form-group\"\u003e\n    \u003clabel for\u003d\"pwd\"\u003ePassword:\u003c/label\u003e\n    \u003cinput type\u003d\"password\" class\u003d\"form-control\" id\u003d\"pwd\"\u003e\n  \u003c/div\u003e\n  \u003cinput type\u003d\"button\" class\u003d\"btn btn-info\" value\u003d\"Save\" id\u003d\"save\"\u003e\n  \u003cinput type\u003d\"button\" class\u003d\"btn btn-info\" value\u003d\"Get Passwords\" id\u003d\"getPwds\"\u003e\n\u003c/form\u003e\n  \n\u003ctable class\u003d\"table table-striped\"\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003eName\u003c/th\u003e\n      \u003cth\u003ePasswords\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody id\u003d\"myUsrPwdsTableBody\"\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\n\n"},{"id":"b53a48c0-a910-4494-9997-d630d8583f0b","name":"JS_ContentInit","type":"html","source":"\u003cscript\u003e\n\n    //contentIndex loading functions\n\n    function updateDiv(content){    \n        $(\"#indexContent\").fadeOut(500,function(){\n          $(\u0027#indexContent\u0027).html(content[0]);\n          $(\"#indexContent\").fadeIn(500);\n          if (content.length \u003e 1) {\n              window[content[1]].call();\n          }\n        })\n    } \n\n    function getContent(content, callbackfname){\n      google.script.run.withSuccessHandler(updateDiv).searchContent(content, callbackfname);      \n    }   \n    \n    //close contentIndex loading functions\n    \n    // generic functions\n    \n    function dataTableToArray(data){\n        var json \u003d JSON.parse(data.toJSON());\n        var rows \u003d json.rows;\n        var resArray \u003d new Array();\n        for(var i in rows) {\n           var jsonRowC \u003d rows[i].c;\n           var arrayRow \u003d new Array();\n           for(var j in jsonRowC) {\n              if (jsonRowC[j]) {\n                 var jsonRowV \u003d jsonRowC[j].v;\n                 arrayRow[j] \u003d jsonRowV;\n              } else {\n                 var jsonRowV \u003d \"\"; \n                 arrayRow[j] \u003d jsonRowV;\n              }\n           }\n           resArray.push(arrayRow);\n        }\n        return resArray;\n    }  \n\n    //close generic functions\n    \n    //contentInit functions\n    \n    function setWelcomeToEmail(data){\n       $(\"#userEmail\").html(data);         \n    }    \n    \n    function init() {\n       google.script.run.withSuccessHandler(setWelcomeToEmail).sesion_GSUserEmail();\n       $(\"#goToForm\").on(\"click\", function(e) {\n          getContent(\u0027contentForm\u0027, \"initContentForm\");\n       });\n    }    \n    \n    $( document ).ready(function() {\n       getContent(\"contentInit\", \"init\");   \n    });\n    \n    //close contentInit functions\n\u003c/script\u003e\n\n\n"},{"id":"54f44408-e4ca-4037-b27d-e0c11157083d","name":"JS_Libs_Ext","type":"html","source":"\u003cscript src\u003d\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js\"\u003e\u003c/script\u003e\n\u003cscript src\u003d\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\"\u003e\u003c/script\u003e\n\u003cscript src\u003d\"https://www.google.com/jsapi?autoload\u003d{\u0027modules\u0027:[{\u0027name\u0027:\u0027visualization\u0027,\u0027version\u0027:\u00271\u0027,\u0027packages\u0027:[\u0027corechart\u0027]}]}\"\u003e\u003c/script\u003e\n\n\n\n\n"},{"id":"f9d9cf45-3c7a-404e-a253-df47235605bd","name":"StyleSheet","type":"html","source":"\u003clink href\u003d\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\" rel\u003d\"stylesheet\"\u003e\n\n\n"},{"id":"efb8f404-6074-4fb5-a410-61a28b1c9e20","name":"JS_ContentForm","type":"html","source":"\u003cscript\u003e\n\n    function initContentForm() {\n       $(\"#save\").on(\"click\", function(e) {\n           save();\n       });\n       $(\"#getPwds\").on(\"click\", function(e) {\n           getPwds();\n       });\n    }\n\n    function save() {\n       var usr \u003d $(\"#usr\").val();\n       var pwd \u003d $(\"#pwd\").val();\n       google.script.run.withSuccessHandler(savedMessage).saveToSheet(usr, pwd);\n    }    \n    \n    function savedMessage(data){\n      alert(data);\n    }\n    \n    function getPwds() {\n       var query \u003d \n       new google.visualization.Query(\n       \"https://docs.google.com/spreadsheets/d/1i4naI0PKSVUWWlKkGPQ8I9-6TpMWPOb0BnQNRc6nfjI/gviz/tq?gid\u003d0\"\n       );\n       query.setQuery(\"select A, B where A \u003d \u0027\" + $(\"#usr\").val() + \"\u0027\");\n       query.send(setPwdsInTable);\n    }\n    \n    function setPwdsInTable(data) {\n       if (data.isError()) {\n          console.log(\u0027Error in query: \u0027 + data.getMessage() + \u0027 \u0027 + data.getDetailedMessage());\n          alert(\"Error to search data!\");\n          return;\n       }\n       var dataResponse \u003d data.getDataTable();\n       var dataArray \u003d dataTableToArray(dataResponse);\n       var tableBody \u003d $(\"#myUsrPwdsTableBody\");\n       tableBody.empty();\n       if ( dataArray.length \u003e 0 ) {\n            for(var i\u003d0; i\u003cdataArray.length; i++) {\n               tableBody.append(\n               \"\u003ctr\u003e\u003ctd\u003e\" + dataArray[i][0] + \"\u003c/td\u003e\u003ctd\u003e\" + dataArray[i][1] + \"\u003c/td\u003e\u003c/tr\u003e\");\n            }\n        }     \n    }\n    \n\u003c/script\u003e\n"}]}